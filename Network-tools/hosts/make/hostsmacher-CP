#!/bin/bash

### Creates route files from files generated by show route command on Checkpoint firewall

workdir=/home/user/scripts/host/configs/CP

dos2unix $workdir/* 2>/dev/null

files=`ls $workdir`

for file in $files
    do

#The following 3 lines are needed if the file contains pages.
#	cat -v $workdir/$file | sed -e 's/^--\ More.*\^H//g' > $workdir/$file-tmp
#	rm -f $workdir/$file
#	mv $workdir/$file-tmp $workdir/$file

	device=`echo $file | sed -e 's/\.tmp$//'`
	cat $workdir/$file | while read line
	do	
	    if [[ "$line" == *Interfaces:* ]];then
		switch=on
	    fi
	    if [ "$switch" == "on" ];then
		ip=`echo $line | awk -F '|' '{print $2}'`
		If=`echo $line | awk -F '|' '{print $1}'`
		if [[ "$ip" == [0-9]* ]];then
		    echo "$ip|$device|||$If|"
		fi
	    fi
	    
	done
done
