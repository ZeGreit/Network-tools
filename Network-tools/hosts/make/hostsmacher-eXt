#!/bin/bash

### Creates hosts file from config files generated by show configuration command on eXtreme devices collected by Ext-coll script and placed in extreme dir

a=`(ls ../extreme/*.tmp)`

for file in $a; do

dos2unix $file 2>/dev/null

cat $file | while read line;
do 
devicet=${file%"."*}
device=${devicet##*"/"}
if [[ "$line" == configure*ipaddress* ]] && [[ "$line" != *access-profile* ]] && [[ "$line" != *snmp* ]] && [[ "$line" != *sflow* ]]
then
If=`echo $line | awk '{print $2"-"$3}'`

if [[ "$line" == *secondary-ipaddress* ]]
then
ip=`echo $line | awk '{print $6}'`
else
ip=`echo $line | awk '{print $5}'`
fi

echo $ip\|$device\|\|\|$If\| | sed -e 's/\"//g'
fi

done
done
