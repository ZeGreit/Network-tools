#!/bin/bash

### Creates route files from files generated by show route command on Checkpoint firewall

workdir=/home/user/scripts/host/configs/CP

dos2unix $workdir/* 2>/dev/null

files=`ls $workdir | grep -v tmp$`

for file in $files
    do

#The following 3 lines are needed if the file contains pages.
#	cat -v $workdir/$file | sed -e 's/^--\ More.*\^H//g' > $workdir/$file-tmp
#	rm -f $workdir/$file
#	mv $workdir/$file-tmp $workdir/$file

	device=`echo $file | awk -F '-' '{print $1}'`
	vsx=`echo $file | awk -F '-' '{print $2}'`
	if [ $vsx ] && [ $vsx != "" ];then
	    vsx=$file
	fi

	cat $workdir/$file | while read line
	do	
	    
	    If=`echo $line | awk -F '|' '{print $2}' | sed -e 's/\ \+$//'`
	    IP=`echo $line | awk -F '|' '{print $3}' | sed -e 's/^v4\ //' | sed -e 's/\ \+$//' | sed -e 's/\/.*$//'`
	    echo "$IP|$device|$vsx||$If|"
	    
	done
done
